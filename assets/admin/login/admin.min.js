document.getElementById('login').onsubmit = login_submit;

function login_submit(e) {
    e.preventDefault();
    //Form Validation
    var emm = document.forms.loginForm.email.value;
    var pwm = document.forms.loginForm.password.value;

    if (emm == "") {
        document.getElementById("ers").innerHTML = "Email is required!";

    } else if (pwm == 0) {
        document.getElementById("ers").innerHTML = "Password is required!";
    } else {
        another();
    }
}

function another() {
    var xhr = new XMLHttpRequest();
    var url = base_url + "admin/login/check_admin_login";
    var em = document.forms.loginForm.email.value;
    var pw = document.forms.loginForm.password.value;
    var cridentials = "email=" + em + "&password=" + pw;

    xhr.open("POST", url, true);
    xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

    xhr.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {

            if (this.responseText == 'not_auth') {
                document.getElementById("ers").innerHTML = "You are not Authorised to Access";
            } else if (this.responseText == 'wrong') {
                document.getElementById("ers").innerHTML = "Wrong Email or Password. Try again";
            } else {
                var lc = base_url + "admin/dashboard";
                window.location.assign(lc);
            }
        }
    }

    xhr.send(cridentials);
}

// remember me on loging script;
$(document).ready(function() {
    var remember = $.cookie('remember');
    if (remember == 'true') {
        var username = $.cookie('email');
        var password = $.cookie('password');
        // autofill the fields
        $('#email').val(username);
        $('#password').val(password);
        $('#remember').attr('check checkbox id..checked', true);
    }

    $("#login").submit(function() {
        if ($('#remember').is(':checked')) {
            var username = $('#email').val();
            var password = $('#password').val();

            // set cookies to expire in 14 days
            $.cookie('email', username, { expires: 14 });
            $.cookie('password', password, { expires: 14 });
            $.cookie('remember', true, { expires: 14 });
        } else {
            // reset cookies
            $.cookie('email', null);
            $.cookie('password', null);
            $.cookie('remember', null);
        }
    });
});